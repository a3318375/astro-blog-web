services:
  astro-koharu:
    image: astro-koharu:latest
    container_name: astro-blog-web
    build:
      context: ..
      dockerfile: docker/Dockerfile
      args:
        - REMARK_URL=${REMARK_URL}
        - REMARK_SITE_ID=${REMARK_SITE_ID}
        - UMAMI_ID=${UMAMI_ID}
        - UMAMI_ENDPOINT=${UMAMI_ENDPOINT}
    # 关键修改：将容器端口从 80 改为 4321
    ports:
      - "${BLOG_PORT:-4321}:4321"
    restart: unless-stopped
    # 建议移除或注释掉，因为你的 Dockerfile 中不再需要它
    # 如果一定要检查，请确保镜像里装了 curl 或 wget
    # healthcheck:
    #   disable: true
    networks:
      - inyaw

networks:
  inyaw:
    external: true
